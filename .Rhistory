lasso.roc= roc(y.test, lasso.pred, quiet=T)
ridge.roc= roc(y.test, ridge.pred, quiet=T)
lasso.pred
lasso.pred
lasso.roc= roc(y.test, lasso.pred, quiet=T)
ridge.roc= roc(y.test, ridge.pred, quiet=T)
#kmeans.roc= roc(y.test, kmens.pred, quiet=T)
hc.roc = roc(as.numeric(tts2$test$cardio), hc.pred, quiet=T)
hc.pred
# #Hierarchical Clust
## dimension reduction
ds = reduce.data.set(data.set, 50, seed)
## split data
tts2 = split_df(ds, ratio=split.ratio, seed=seed)
gower.dist = daisy(tts2$train[,-12], metric ="gower")
hc.mod = hclust(gower.dist, method="ward.D2")
groups = cutree(hc.mod, k=2)-1
hc.pred = knn(train=tts2$train[,-12], test=tts2$test[,-12], cl=groups, k=1)
hc.pred
attributes(hc.pred)$prob
gower.dist = daisy(tts2$train[,-12], metric ="gower")
hc.mod = hclust(gower.dist, method="ward.D2")
groups = cutree(hc.mod, k=2)-1
hc.pred = knn(train=tts2$train[,-12], test=tts2$test[,-12], cl=groups, k=1, prob= T)
hc.pred = attributes(hc.pred)$prob
#kmeans.roc= roc(y.test, kmens.pred, quiet=T)
hc.roc = roc(as.numeric(tts2$test$cardio), hc.pred, quiet=T)
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc,
#KMeans = kmeans.roc,
HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
theme_set(theme_minimal())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc,
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc,
#KMeans = kmeans.roc,
#HC    = hc.roc
)
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc,
#KMeans = kmeans.roc,
#HC    = hc.roc
)
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
#QDA   = qda.roc,
Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
#Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc
#Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
#LogR  = logr.roc, diff
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
#LogR  = logr.roc,
LDA   = lda.roc,
#QDA   = qda.roc,
Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
#LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
#Lasso = lasso.roc
Ridge = ridge.roc
#KMeans = kmeans.roc,
#HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
roc.mods= list(
#LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
#Lasso = lasso.roc
#Ridge = ridge.roc
#KMeans = kmeans.roc,
HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
# #Hierarchical Clust
## dimension reduction
ds = reduce.data.set(data.set, 1000, seed)
## split data
tts2 = split_df(ds, ratio=split.ratio, seed=seed)
gower.dist = daisy(tts2$train[,-12], metric ="gower")
hc.mod = hclust(gower.dist, method="ward.D2")
groups = cutree(hc.mod, k=2)-1
hc.pred = knn(train=tts2$train[,-12], test=tts2$test[,-12], cl=groups, k=1, prob= T)
# #Hierarchical Clust
## dimension reduction
ds = reduce.data.set(data.set, 35000, seed)
## split data
tts2 = split_df(ds, ratio=split.ratio, seed=seed)
gower.dist = daisy(tts2$train[,-12], metric ="gower")
hc.mod = hclust(gower.dist, method="ward.D2")
groups = cutree(hc.mod, k=2)-1
hc.pred = knn(train=tts2$train[,-12], test=tts2$test[,-12], cl=groups, k=1, prob= T)
hc.pred = attributes(hc.pred)$prob
#kmeans.roc= roc(y.test, kmens.pred, quiet=T)
hc.roc = roc(as.numeric(tts2$test$cardio), hc.pred, quiet=T)
roc.mods= list(
LogR  = logr.roc,
LDA   = lda.roc,
QDA   = qda.roc,
Lasso = lasso.roc,
Ridge = ridge.roc,
#KMeans = kmeans.roc,
HC    = hc.roc
)
theme_set(theme_bw())
ggroc(
roc.mods,
size= 0.8,
legacy.axes= T #normal order axes
) +
# annotate(
#   geom= "text",
#   x= c(0.6, 0.6, 0.6, 0.6, 0.6),
#   y= c(0.75, 0.7, 0.65, 0.6, 0.55),
#   size=2,
#   label= auc.labels,
#   col= cols5,
#   parse= T,
#   hjust= 0
# ) +
labs(
x= "False Positive Ratio",
y= "True Positive Ratio",
col= "Models"
) +
ggtitle("ROC curves and respective AUCs") +
theme(legend.title= element_text(size= 12)) +
scale_x_continuous(labels= scales::percent) +
scale_y_continuous(labels= scales::percent) +
coord_fixed()
