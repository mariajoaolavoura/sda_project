geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
## Contributions
pca$var$contrib
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 7") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 20") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 25") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,2), select="contrib 25") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,2), select="contrib 25") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 25") # plot the 5 individuals with the highest contribution
# as proof of what was concluded is write... (I'm very clever ehehe)
ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
#geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
# as proof of what was concluded is write... (I'm very clever ehehe)
ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
#geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
#geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point(0,0)+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.lat, y=gal.long))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-4,4), y=c(-2,2))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.lat, y=gal.long))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g$coordinates
g$layers
g$scales
g$theme
g$facet
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,3), y=c(-1.5,1.5))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3.25,3.1), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3.25,3.25), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3.5,3.5), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3.75,3.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3.5,3.5), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-2.75,2.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-2.75,2.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-2.75,3.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-2.75,3), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.75), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.9), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.25,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.5,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.3,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.2,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.2,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
## quality of representation - cos2
pca$ind$cos2
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
pca$ind$contrib[c(5,6,13,19,22),]
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
pca$ind$contrib[c(5,6,29,99,104),]
pca$ind$cos2[c(5,6,29,99,104),]
pca$ind$cos2[c(5,6,13,19,22),]
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
sum(pca$ind$cos2[22, ])
sum(pca$ind$cos2[22, c(1,2)])
sum(pca$ind$cos2[22, c(1,2,3)])
sum(pca$ind$cos2[5, c(1,2,3)])
sum(pca$ind$cos26, c(1,2,3)])
sum(pca$ind$cos2[6, c(1,2,3)])
sum(pca$ind$cos2[13, c(1,2,3)])
sum(pca$ind$cos2[19, c(1,2,3)])
## Eigenvectors
pca$svd$V
## Eigenvalues
pca$eig
## Eigenvectors
pca$svd$V
## Eigenvalues
pca$eig
## Eigenvectors
pca$svd$V
## libraries
library("FactoMineR")
library(ggplot2)
## libraries
library(FactoMineR)
library(ggplot2)
set.seed(123)
## Read data frame
df = readRDS("./data/location.dat")
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
## Interpretation - In regard of the variables
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
## PCA
pca = PCA(df)
## Eigenvalues
pca$eig
## easier to see the "elbow"
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
## Interpretation - In regard of the variables
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
## correlations variables - dimensions/PC
pca$var$cor
## Contributions
pca$var$contrib
## Contributions
sum(pca$var$contrib[,4])
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.lat, y=gal.long))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
## coordinates of the individuals
## which ones are more extreme in each PC
pca$ind$coord
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
save_and_plot = function(p, name) {
png(name)
p
dev.off()
}
## easier to see the "elbow"
b = barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
save_and_plot = function(p, name) {
png(name)
p
dev.off()
}
## easier to see the "elbow"
b = barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
save_and_plot(b, "loc_eigen_barplot.png")
save_and_plot = function(p, name) {
png(name)
plot(p)
dev.off()
}
## easier to see the "elbow"
b = barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
save_and_plot(b, "loc_eigen_barplot.png")
## easier to see the "elbow"
png("loc_eigen_barplot.png")
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
dev.off()
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
## Interpretation - In regard of the variables
png("loc_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
dev.off()
png("loc_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
dev.off()
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
