main="Eigenvalues",
names.arg=1:nrow(pca$eig))
save_and_plot(b, "loc_eigen_barplot.png")
save_and_plot = function(p, name) {
png(name)
plot(p)
dev.off()
}
## easier to see the "elbow"
b = barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
save_and_plot(b, "loc_eigen_barplot.png")
## easier to see the "elbow"
png("loc_eigen_barplot.png")
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
dev.off()
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
## Interpretation - In regard of the variables
png("loc_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
dev.off()
png("loc_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
dev.off()
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
## libraries
library(FactoMineR)
library(ggplot2)
set.seed(123)
## Read data frame
df = readRDS("./data/location.dat")
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
## Eigenvalues
pca$eig
## easier to see the "elbow"
png("loc_eigen_barplot.png")
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
dev.off()
## Interpretation - In regard of the variables
png("loc_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
dev.off()
png("loc_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
dev.off()
## correlations variables - dimensions/PC
pca$var$cor
## Contributions
pca$var$contrib
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.lat, y=gal.long))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_coord.png", g)
## coordinates of the individuals
## which ones are more extreme in each PC
pca$ind$coord
png("loc_pca_graph_ind_dim12.png")
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
dev.off()
png("loc_pca_graph_ind_dim13.png")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
dev.off()
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.lat, y=gal.long))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
ggsave("loc_clusters_specific_coord.png", g)
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
dev.off()
png("loc_pca_graph_ind_dim12_contr5.png")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
png("loc_pca_graph_ind_dim13_contr5.png")
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
pca$ind$contrib[c(5,6,13,19,22),]
## quality of representation - cos2
pca$ind$cos2
png("loc_pca_graph_ind_dim12_cos0.8.png")
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
dev.off()
png("loc_pca_graph_ind_dim12_cos5.png")
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
dev.off()
pca$ind$cos2[c(5,6,29,99,104),]
pca$ind$cos2[c(5,6,13,19,22),]
## Eigenvectors
pca$svd$V
## Eigenvalues
pca$eig
# PC1 has a 50% of total variance
# PC1 has a 50% of total variance
# PC2 has a 27% of total variance
# PC1 has a 50% of total variance
# PC2 has a 27% of total variance
# PC3 has a 22% of total variance
## libraries
library("FactoMineR")
set.seed(123)
## Read data frame
df = readRDS("./data/dynamics.dat")
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
pca
## Eigenvalues
pca$eig
## easier to see the "elbow"
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
## Interpretation - In regard of the variables
#png("loc_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
#dev.off()
#png("loc_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
## correlations variables - dimensions/PC
pca$var$cor
## correlations variables - dimensions/PC
plot(pca$var$cor)
## correlations variables - dimensions/PC
plot(pca$var$cor)
## correlations variables - dimensions/PC
barplot(pca$var$cor)
## correlations variables - dimensions/PC
pca$var$cor
## Contributions
pca$var$contrib
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.lat, y=gal.long))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="latitude",
y="longitude")
g
## coordinates of the individuals
## which ones are more extreme in each PC
pca$ind$coord
#png("loc_pca_graph_ind_dim12.png")
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_ind_dim13.png")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_var_dim14.png")
plot(pca, axes = c(1,4), choix = c("var"), col.var="black")
#dev.off()
#png("loc_pca_graph_var_dim15.png")
plot(pca, axes = c(1,5), choix = c("var"), col.var="black")
#png("loc_pca_graph_ind_dim12.png")
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_ind_dim13.png")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_ind_dim15.png")
plot(pca, axes = c(1,4), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_ind_dim15.png")
plot(pca, axes = c(1,5), choix = c("ind","var","varcor"), col.var="black")
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
#dev.off()
#png("loc_pca_graph_ind_dim12_contr5.png")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim13_contr5.png")
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim14_contr5.png")
plot(pca, axes = c(1,4), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim15_contr5.png")
plot(pca, axes = c(1,5), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim15_contr5.png")
plot(pca, axes = c(1,5), select="contrib 7") # plot the 5 individuals with the highest contribution
pca$ind$contrib[c(5,6,13,19,22),]
pca$ind$contrib[c(5,6,13,20,63,110),]
## quality of representation - cos2
pca$ind$cos2
#png("loc_pca_graph_ind_dim12_cos0.8.png")
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
#dev.off()
#png("loc_pca_graph_ind_dim12_cos5.png")
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
pca$ind$cos2[c(24,29,35,107,111),]
pca$ind$cos2[c(5,6,13,20,63,110),]
## Eigenvectors
pca$svd$V
## Eigenvalues
pca$eig
## libraries
library(FactoMineR)
library(ggplot2)
set.seed(123)
## Read data frame
df = readRDS("./data/dynamics.dat")
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
## Eigenvalues
pca$eig
## easier to see the "elbow"
png("dyn_eigen_barplot.png")
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
dev.off()
## Interpretation - In regard of the variables
png("dyn_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
dev.off()
png("dyn_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
dev.off()
png("dyn_pca_graph_var_dim14.png")
plot(pca, axes = c(1,4), choix = c("var"), col.var="black")
dev.off()
png("dyn_pca_graph_var_dim15.png")
plot(pca, axes = c(1,5), choix = c("var"), col.var="black")
dev.off()
## correlations variables - dimensions/PC
pca$var$cor
## Contributions
pca$var$contrib
## Contributions
pca$var$contrib
## coordinates of the individuals
## which ones are more extreme in each PC
pca$ind$coord
png("dyn_pca_graph_ind_dim12.png")
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
dev.off()
png("dyn_pca_graph_ind_dim13.png")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
dev.off()
png("dyn_pca_graph_ind_dim15.png")
plot(pca, axes = c(1,4), choix = c("ind","var","varcor"), col.var="black")
dev.off()
png("dyn_pca_graph_ind_dim15.png")
plot(pca, axes = c(1,5), choix = c("ind","var","varcor"), col.var="black")
dev.off()
## Contributions
## the more extreme will have the higher contribution
pca$ind$contrib
dev.off()
png("dyn_pca_graph_ind_dim12_contr5.png")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
png("dyn_pca_graph_ind_dim13_contr5.png")
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
png("dyn_pca_graph_ind_dim14_contr5.png")
plot(pca, axes = c(1,4), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
png("dyn_pca_graph_ind_dim15_contr5.png")
plot(pca, axes = c(1,5), select="contrib 5") # plot the 5 individuals with the highest contribution
dev.off()
pca$ind$contrib[c(5,6,13,20,63,110),]
## quality of representation - cos2
pca$ind$cos2
png("dyn_pca_graph_ind_dim12_cos0.8.png")
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
dev.off()
png("dyn_pca_graph_ind_dim12_cos5.png")
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
dev.off()
## Read data frame
loc = readRDS("./data/location.dat")
dyn = readRDS("./data/dynamics.dat")
df = dyn
dim(df)
## Read data frame
loc = readRDS("./data/location.dat")
dyn = readRDS("./data/dynamics.dat")
df = dyn
df$gal.long = loc$gal.long
df$gal.lat = loc$gal.lat
df$r.sol = loc$r.sol
df$r.gc = loc$r.gc
dim(df)
View(df)
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
## libraries
library(FactoMineR)
library(ggplot2)
set.seed(123)
## Read data frame
df = readRDS("./data/location.dat")
# View(df)
# dim(df)
# str(df)
summary(df)
## PCA
pca = PCA(df)
## Eigenvalues
pca$eig
## Eigenvalues
pca$eig
## easier to see the "elbow"
#png("loc_eigen_barplot.png")
barplot(pca$eig[,1],
main="Eigenvalues",
names.arg=1:nrow(pca$eig))
## Interpretation - In regard of the variables
#png("loc_pca_graph_var_dim12.png")
plot(pca, axes = c(1,2), choix = c("var"), col.var="black")
#dev.off()
#png("loc_pca_graph_var_dim13.png")
plot(pca, axes = c(1,3), choix = c("var"), col.var="black")
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
## correlations variables - dimensions/PC
pca$var$cor
## Contributions
pca$var$contrib
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
ggsave("loc_clusters_coord.png", g)
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point(shape=18)+
geom_point(x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(shape=18,x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(shape=cyl,x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(shape=21,x=0,y=0)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(shape=21,x=0,y=0, size=5)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
ggsave("loc_clusters_coord.png", g)
## coordinates of the individuals
## which ones are more extreme in each PC
pca$ind$coord
#png("loc_pca_graph_ind_dim12.png")
plot(pca, axes = c(1,2), choix = c("ind","var","varcor"), col.var="black")
#dev.off()
#png("loc_pca_graph_ind_dim13.png")
plot(pca, axes = c(1,3), choix = c("ind","var","varcor"), col.var="black")
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.long, y=gal.lat))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0)+
#lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.long, y=gal.lat))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0, shape=21, size=5)+
#lims(x=c(-3,2.8), y=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.long, y=gal.lat))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0, shape=21, size=5)+
lims(y=c(-3,2.8), x=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
ggsave("loc_clusters_specific_coord.png", g)
#dev.off()
#png("loc_pca_graph_ind_dim12_contr5.png")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
# as proof of what was concluded is write... (I'm very clever ehehe)
g = ggplot(df[c(5,6,13,19,22),], aes(x=gal.long, y=gal.lat))+
geom_hline(yintercept=0)+
geom_point()+
geom_text(aes(label=c("5","6","13","19","22")),hjust=0, vjust=0)+
geom_point(x=0,y=0, shape=21, size=5)+
lims(y=c(-3,2.8), x=c(-1.1,1.25))+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
g
#dev.off()
#png("loc_pca_graph_ind_dim13_contr5.png")
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim12_contr5.png")
plot(pca, axes = c(1,2), select="contrib 5") # plot the 5 individuals with the highest contribution
#dev.off()
#png("loc_pca_graph_ind_dim13_contr5.png")
plot(pca, axes = c(1,3), select="contrib 5") # plot the 5 individuals with the highest contribution
## Interpretation - In regard of the individuals
g = ggplot(df, aes(x=gal.long, y=gal.lat))+
geom_point()+
geom_point(shape=21,x=0,y=0, size=5)+
geom_hline(yintercept=0)+
labs(title="Distribution of globular clusters through space",
x="longitude",
y="latitude")
## quality of representation - cos2
pca$ind$cos2
#png("loc_pca_graph_ind_dim12_cos0.8.png")
plot(pca,select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
plot(pca,axes = c(1,3),select="cos2 0.8")  # plot the individuals with cos2 greater than 0.8
#dev.off()
#png("loc_pca_graph_ind_dim12_cos5.png")
plot(pca,select="cos2 5")    # plot the 5 individuals with the highest cos2
pca$ind$cos2[c(5,6,29,99,104),]
pca$ind$cos2[c(5,6,13,19,22),]
## Eigenvectors
pca$svd$V
## Eigenvalues
pca$eig
## Eigenvectors
pca$svd$V
## Eigenvectors
pca$svd$V
